<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | MiAmor</title>
    <link rel="shortcut icon" href="assets/favicon.ico">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #04091A; color: #f0f4f8; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { max-width: 500px; width: 90%; background: #0a192f; padding: 2rem; border-radius: 10px; border: 1px solid rgba(0, 242, 254, 0.2); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        h1 { color: #00f2fe; text-align: center; margin-bottom: 2rem; }
        .form-group { margin-bottom: 1.5rem; }
        label { display: block; margin-bottom: 0.5rem; color: #a9b7d1; }
        input { width: 100%; padding: 12px; border-radius: 5px; border: 1px solid rgba(0, 242, 254, 0.3); background-color: #02040a; color: #f0f4f8; font-size: 1rem; box-sizing: border-box; }
        input:focus { outline: none; border-color: #00f2fe; box-shadow: 0 0 10px rgba(0, 242, 254, 0.3); }
        button { width: 100%; padding: 14px; border: none; border-radius: 5px; background-color: #2c72ff; color: white; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: background-color 0.2s; }
        button:hover { background-color: #00f2fe; color: #02040a; }
        button:disabled { background-color: #555; cursor: not-allowed; }
        #status { text-align: center; margin-top: 1rem; font-weight: bold; color: #28a745; height: 20px; }
    </style>
</head>
<body>

    <div class="container" id="admin-panel" style="display: none;">
        <h1>Edit Payment Details</h1>
        <form id="settings-form">
            <div class="form-group">
                <label for="account-name">Account Holder Name</label>
                <input type="text" id="account-name" required>
            </div>
            <div class="form-group">
                <label for="bank-name">Bank Name</label>
                <input type="text" id="bank-name" required>
            </div>
            <div class="form-group">
                <label for="account-number">Account Number</label>
                <input type="text" id="account-number" required>
            </div>
            <div class="form-group">
                <label for="whatsapp-number">WhatsApp Number (e.g., 2348012345678)</label>
                <input type="text" id="whatsapp-number" required>
            </div>
            <button type="submit" id="save-button">Save Changes</button>
        </form>
        <p id="status"></p>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        // 1. PASTE YOUR FIREBASE CONFIG OBJECT HERE
        const firebaseConfig = {
    apiKey: "AIzaSyA4Gg55H25MqGbxD4rsP14gdbR0H7FVgoI",
    authDomain: "miamor-payment-details-6c720.firebaseapp.com",
    databaseURL: "https://miamor-payment-details-6c720-default-rtdb.firebaseio.com",
    projectId: "miamor-payment-details-6c720",
    storageBucket: "miamor-payment-details-6c720.firebasestorage.app",
    messagingSenderId: "710248117440",
    appId: "1:710248117440:web:53c265ef576e3821642925",
    measurementId: "G-4577S38C0V"
  };

        // 2. SET YOUR CLIENT'S SECRET PASSWORD HERE
        const correctPassword = "salami.miamor";

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const settingsRef = database.ref('settings');

        // Main logic
        document.addEventListener('DOMContentLoaded', () => {
            const adminPanel = document.getElementById('admin-panel');
            const settingsForm = document.getElementById('settings-form');
            const saveButton = document.getElementById('save-button');
            const statusEl = document.getElementById('status');
            
            // Password prompt
            const password = prompt("Please enter the admin password:");

            if (password === correctPassword) {
                adminPanel.style.display = 'block';
                loadSettings();
            } else {
                alert("Incorrect password. Access denied.");
                document.body.innerHTML = '<h1 style="color: #ff4d4d;">Access Denied</h1>';
            }

            // Function to load current settings into the form
            function loadSettings() {
                settingsRef.get().then((snapshot) => {
                    if (snapshot.exists()) {
                        const data = snapshot.val();
                        document.getElementById('account-name').value = data.account_name || '';
                        document.getElementById('bank-name').value = data.bank_name || '';
                        document.getElementById('account-number').value = data.account_number || '';
                        document.getElementById('whatsapp-number').value = data.whatsapp_number || '';
                    } else {
                        console.log("No data available");
                    }
                }).catch((error) => {
                    console.error(error);
                    statusEl.textContent = 'Error loading data.';
                    statusEl.style.color = '#ff4d4d';
                });
            }

            // Function to save the form data to Firebase
            settingsForm.addEventListener('submit', (e) => {
                e.preventDefault();
                saveButton.disabled = true;
                saveButton.textContent = 'Saving...';
                statusEl.textContent = '';

                const newSettings = {
                    account_name: document.getElementById('account-name').value,
                    bank_name: document.getElementById('bank-name').value,
                    account_number: document.getElementById('account-number').value,
                    whatsapp_number: document.getElementById('whatsapp-number').value
                };

                settingsRef.set(newSettings)
                    .then(() => {
                        statusEl.textContent = 'Settings saved successfully!';
                        statusEl.style.color = '#28a745';
                        setTimeout(() => statusEl.textContent = '', 3000);
                    })
                    .catch((error) => {
                        console.error('Save failed:', error);
                        statusEl.textContent = 'Error: Could not save settings.';
                        statusEl.style.color = '#ff4d4d';
                    })
                    .finally(() => {
                        saveButton.disabled = false;
                        saveButton.textContent = 'Save Changes';
                    });
            });
        });
    </script>
</body>
</html>